{"ast":null,"code":"var _jsxFileName = \"/Users/yati/Desktop/react/react-front/src/post/SinglePost.js\";\nimport React, { Component } from 'react';\nimport { singlePost, remove } from './apiPost';\nimport DefaultPost from '../images/mountains.jpg';\nimport { Link, Redirect } from 'react-router-dom';\nimport { isAuthenticated } from '../auth';\nimport Comment from './Comment';\n\nclass SinglePost extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      post: '',\n      redirectToHome: false,\n      redirectToSignin: false,\n      like: false,\n      likes: 0,\n      comments: []\n    };\n\n    this.checkLike = likes => {\n      const userId = isAuthenticated() && isAuthenticated().user._id;\n\n      let match = likes.indexOf(userId) !== -1;\n      return match;\n    };\n\n    this.componentDidMount = () => {\n      const postId = this.props.match.params.postId;\n      singlePost(postId).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            post: data,\n            likes: data.likes.length,\n            like: this.checkLike(data.likes),\n            comments: data.comments\n          });\n        }\n      });\n    };\n\n    this.updateComments = comments => {\n      this.setState({\n        comments\n      });\n    };\n\n    this.likeToggle = () => {\n      if (!isAuthenticated()) {\n        this.setState({\n          redirectToSignin: true\n        });\n        return false;\n      }\n\n      let callApi = this.state.like ? unlike : like;\n\n      const userId = isAuthenticated().user._id;\n\n      const postId = this.state.post._id;\n      const token = isAuthenticated().token;\n      callApi(userId, token, postId).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            like: !this.state.like,\n            likes: data.likes.length\n          });\n        }\n      });\n    };\n\n    this.deletePost = () => {\n      const postId = this.props.match.params.postId;\n      const token = isAuthenticated().token;\n      remove(postId, token).then(data => {\n        if (data.error) {\n          console.log(data.error);\n        } else {\n          this.setState({\n            redirectToHome: true\n          });\n        }\n      });\n    };\n\n    this.deleteConfirmed = () => {\n      let answer = window.confirm('Are you sure you want to delete your post?');\n\n      if (answer) {\n        this.deletePost();\n      }\n    };\n\n    this.renderPost = post => {\n      const posterId = post.postedBy ? `/user/${post.postedBy._id}` : '';\n      const posterName = post.postedBy ? post.postedBy.name : ' Unknown';\n      const {\n        like,\n        likes\n      } = this.state;\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card-body\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: `${process.env.REACT_APP_API_URL}/post/photo/${post._id}`,\n        alt: post.title,\n        onError: i => i.target.src = `${DefaultPost}`,\n        className: \"img-thunbnail mb-3\",\n        style: {\n          height: '300px',\n          width: '100%',\n          objectFit: 'cover'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 17\n        }\n      }), like ? /*#__PURE__*/React.createElement(\"h3\", {\n        onClick: this.likeToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-thumbs-up text-success bg-dark\",\n        style: {\n          padding: '10px',\n          borderRadius: '50%'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 107,\n          columnNumber: 25\n        }\n      }), ' ', likes, \" Like\") : /*#__PURE__*/React.createElement(\"h3\", {\n        onClick: this.likeToggle,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"i\", {\n        className: \"fa fa-thumbs-up text-warning bg-dark\",\n        style: {\n          padding: '10px',\n          borderRadius: '50%'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 25\n        }\n      }), ' ', likes, \" Like\"), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"card-text\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 17\n        }\n      }, post.body), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"font-italic mark\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 17\n        }\n      }, \"Posted by \", /*#__PURE__*/React.createElement(Link, {\n        to: `${posterId}`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 31\n        }\n      }, posterName, \" \"), \"on \", new Date(post.created).toDateString()), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-inline-block\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(Link, {\n        to: `/`,\n        className: \"btn btn-raised btn-primary btn-sm mr-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 21\n        }\n      }, \"Back to posts\"), isAuthenticated().user && isAuthenticated().user._id === post.postedBy._id && /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(Link, {\n        to: `/post/edit/${post._id}`,\n        className: \"btn btn-raised btn-warning btn-sm mr-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 29\n        }\n      }, \"Update Post\"), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.deleteConfirmed,\n        className: \"btn btn-raised btn-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 29\n        }\n      }, \"Delete Post\")), /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 145,\n          columnNumber: 21\n        }\n      }, isAuthenticated().user && isAuthenticated().user.role === 'admin' && /*#__PURE__*/React.createElement(\"div\", {\n        class: \"card mt-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 147,\n          columnNumber: 29\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"card-body\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 33\n        }\n      }, /*#__PURE__*/React.createElement(\"h5\", {\n        className: \"card-title\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 37\n        }\n      }, \"Admin\"), /*#__PURE__*/React.createElement(\"p\", {\n        className: \"mb-2 text-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 150,\n          columnNumber: 37\n        }\n      }, \"Edit/Delete as an Admin\"), /*#__PURE__*/React.createElement(Link, {\n        to: `/post/edit/${post._id}`,\n        className: \"btn btn-raised btn-warning btn-sm mr-5\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 151,\n          columnNumber: 37\n        }\n      }, \"Update Post\"), /*#__PURE__*/React.createElement(\"button\", {\n        onClick: this.deleteConfirmed,\n        className: \"btn btn-raised btn-danger\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157,\n          columnNumber: 37\n        }\n      }, \"Delete Post\"))))));\n    };\n  }\n\n  render() {\n    const {\n      post,\n      redirectToHome,\n      redirectToSignin,\n      comments\n    } = this.state;\n\n    if (redirectToHome) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: `/`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 173,\n          columnNumber: 20\n        }\n      });\n    } else if (redirectToSignin) {\n      return /*#__PURE__*/React.createElement(Redirect, {\n        to: `/signin`,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 20\n        }\n      });\n    }\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      className: \"display-2 mt-5 mb-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 180,\n        columnNumber: 17\n      }\n    }, post.title), !post ? /*#__PURE__*/React.createElement(\"div\", {\n      className: \"jumbotron text-center\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h2\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 25\n      }\n    }, \"Loading...\")) : this.renderPost(post), /*#__PURE__*/React.createElement(Comment, {\n      postId: post._id,\n      comments: comments.reverse(),\n      updateComments: this.updateComments,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 17\n      }\n    }));\n  }\n\n}\n\nexport default SinglePost;","map":{"version":3,"sources":["/Users/yati/Desktop/react/react-front/src/post/SinglePost.js"],"names":["React","Component","singlePost","remove","DefaultPost","Link","Redirect","isAuthenticated","Comment","SinglePost","state","post","redirectToHome","redirectToSignin","like","likes","comments","checkLike","userId","user","_id","match","indexOf","componentDidMount","postId","props","params","then","data","error","console","log","setState","length","updateComments","likeToggle","callApi","unlike","token","deletePost","deleteConfirmed","answer","window","confirm","renderPost","posterId","postedBy","posterName","name","process","env","REACT_APP_API_URL","title","i","target","src","height","width","objectFit","padding","borderRadius","body","Date","created","toDateString","role","render","reverse"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,SAASC,UAAT,EAAqBC,MAArB,QAAkC,WAAlC;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,SAASC,IAAT,EAAeC,QAAf,QAA+B,kBAA/B;AACA,SAASC,eAAT,QAAgC,SAAhC;AACA,OAAOC,OAAP,MAAoB,WAApB;;AAEA,MAAMC,UAAN,SAAyBR,SAAzB,CAAmC;AAAA;AAAA;AAAA,SAC/BS,KAD+B,GACvB;AACJC,MAAAA,IAAI,EAAE,EADF;AAEJC,MAAAA,cAAc,EAAE,KAFZ;AAGJC,MAAAA,gBAAgB,EAAE,KAHd;AAIJC,MAAAA,IAAI,EAAE,KAJF;AAKJC,MAAAA,KAAK,EAAE,CALH;AAMJC,MAAAA,QAAQ,EAAE;AANN,KADuB;;AAAA,SAU/BC,SAV+B,GAUnBF,KAAK,IAAI;AACjB,YAAMG,MAAM,GAAGX,eAAe,MAAMA,eAAe,GAAGY,IAAlB,CAAuBC,GAA3D;;AACA,UAAIC,KAAK,GAAGN,KAAK,CAACO,OAAN,CAAcJ,MAAd,MAA0B,CAAC,CAAvC;AACA,aAAOG,KAAP;AACH,KAd8B;;AAAA,SAgB/BE,iBAhB+B,GAgBX,MAAM;AACtB,YAAMC,MAAM,GAAG,KAAKC,KAAL,CAAWJ,KAAX,CAAiBK,MAAjB,CAAwBF,MAAvC;AACAtB,MAAAA,UAAU,CAACsB,MAAD,CAAV,CAAmBG,IAAnB,CAAwBC,IAAI,IAAI;AAC5B,YAAIA,IAAI,CAACC,KAAT,EAAgB;AACZC,UAAAA,OAAO,CAACC,GAAR,CAAYH,IAAI,CAACC,KAAjB;AACH,SAFD,MAEO;AACH,eAAKG,QAAL,CAAc;AACVrB,YAAAA,IAAI,EAAEiB,IADI;AAEVb,YAAAA,KAAK,EAAEa,IAAI,CAACb,KAAL,CAAWkB,MAFR;AAGVnB,YAAAA,IAAI,EAAE,KAAKG,SAAL,CAAeW,IAAI,CAACb,KAApB,CAHI;AAIVC,YAAAA,QAAQ,EAAEY,IAAI,CAACZ;AAJL,WAAd;AAMH;AACJ,OAXD;AAYH,KA9B8B;;AAAA,SAgC/BkB,cAhC+B,GAgCdlB,QAAQ,IAAI;AACzB,WAAKgB,QAAL,CAAc;AAAEhB,QAAAA;AAAF,OAAd;AACH,KAlC8B;;AAAA,SAoC/BmB,UApC+B,GAoClB,MAAM;AACf,UAAI,CAAC5B,eAAe,EAApB,EAAwB;AACpB,aAAKyB,QAAL,CAAc;AAAEnB,UAAAA,gBAAgB,EAAE;AAApB,SAAd;AACA,eAAO,KAAP;AACH;;AACD,UAAIuB,OAAO,GAAG,KAAK1B,KAAL,CAAWI,IAAX,GAAkBuB,MAAlB,GAA2BvB,IAAzC;;AACA,YAAMI,MAAM,GAAGX,eAAe,GAAGY,IAAlB,CAAuBC,GAAtC;;AACA,YAAMI,MAAM,GAAG,KAAKd,KAAL,CAAWC,IAAX,CAAgBS,GAA/B;AACA,YAAMkB,KAAK,GAAG/B,eAAe,GAAG+B,KAAhC;AAEAF,MAAAA,OAAO,CAAClB,MAAD,EAASoB,KAAT,EAAgBd,MAAhB,CAAP,CAA+BG,IAA/B,CAAoCC,IAAI,IAAI;AACxC,YAAIA,IAAI,CAACC,KAAT,EAAgB;AACZC,UAAAA,OAAO,CAACC,GAAR,CAAYH,IAAI,CAACC,KAAjB;AACH,SAFD,MAEO;AACH,eAAKG,QAAL,CAAc;AACVlB,YAAAA,IAAI,EAAE,CAAC,KAAKJ,KAAL,CAAWI,IADR;AAEVC,YAAAA,KAAK,EAAEa,IAAI,CAACb,KAAL,CAAWkB;AAFR,WAAd;AAIH;AACJ,OATD;AAUH,KAxD8B;;AAAA,SA0D/BM,UA1D+B,GA0DlB,MAAM;AACf,YAAMf,MAAM,GAAG,KAAKC,KAAL,CAAWJ,KAAX,CAAiBK,MAAjB,CAAwBF,MAAvC;AACA,YAAMc,KAAK,GAAG/B,eAAe,GAAG+B,KAAhC;AACAnC,MAAAA,MAAM,CAACqB,MAAD,EAASc,KAAT,CAAN,CAAsBX,IAAtB,CAA2BC,IAAI,IAAI;AAC/B,YAAIA,IAAI,CAACC,KAAT,EAAgB;AACZC,UAAAA,OAAO,CAACC,GAAR,CAAYH,IAAI,CAACC,KAAjB;AACH,SAFD,MAEO;AACH,eAAKG,QAAL,CAAc;AAAEpB,YAAAA,cAAc,EAAE;AAAlB,WAAd;AACH;AACJ,OAND;AAOH,KApE8B;;AAAA,SAsE/B4B,eAtE+B,GAsEb,MAAM;AACpB,UAAIC,MAAM,GAAGC,MAAM,CAACC,OAAP,CAAe,4CAAf,CAAb;;AACA,UAAIF,MAAJ,EAAY;AACR,aAAKF,UAAL;AACH;AACJ,KA3E8B;;AAAA,SA6E/BK,UA7E+B,GA6ElBjC,IAAI,IAAI;AACjB,YAAMkC,QAAQ,GAAGlC,IAAI,CAACmC,QAAL,GAAiB,SAAQnC,IAAI,CAACmC,QAAL,CAAc1B,GAAI,EAA3C,GAA+C,EAAhE;AACA,YAAM2B,UAAU,GAAGpC,IAAI,CAACmC,QAAL,GAAgBnC,IAAI,CAACmC,QAAL,CAAcE,IAA9B,GAAqC,UAAxD;AAEA,YAAM;AAAElC,QAAAA,IAAF;AAAQC,QAAAA;AAAR,UAAkB,KAAKL,KAA7B;AAEA,0BACI;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AACI,QAAA,GAAG,EAAG,GAAEuC,OAAO,CAACC,GAAR,CAAYC,iBAAkB,eAAcxC,IAAI,CAACS,GAAI,EADjE;AAEI,QAAA,GAAG,EAAET,IAAI,CAACyC,KAFd;AAGI,QAAA,OAAO,EAAEC,CAAC,IAAKA,CAAC,CAACC,MAAF,CAASC,GAAT,GAAgB,GAAEnD,WAAY,EAHjD;AAII,QAAA,SAAS,EAAC,oBAJd;AAKI,QAAA,KAAK,EAAE;AACHoD,UAAAA,MAAM,EAAE,OADL;AAEHC,UAAAA,KAAK,EAAE,MAFJ;AAGHC,UAAAA,SAAS,EAAE;AAHR,SALX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAaK5C,IAAI,gBACD;AAAI,QAAA,OAAO,EAAE,KAAKqB,UAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AACI,QAAA,SAAS,EAAC,sCADd;AAEI,QAAA,KAAK,EAAE;AAAEwB,UAAAA,OAAO,EAAE,MAAX;AAAmBC,UAAAA,YAAY,EAAE;AAAjC,SAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAIO,GAJP,EAKK7C,KALL,UADC,gBASD;AAAI,QAAA,OAAO,EAAE,KAAKoB,UAAlB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AACI,QAAA,SAAS,EAAC,sCADd;AAEI,QAAA,KAAK,EAAE;AAAEwB,UAAAA,OAAO,EAAE,MAAX;AAAmBC,UAAAA,YAAY,EAAE;AAAjC,SAFX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QADJ,EAIO,GAJP,EAKK7C,KALL,UAtBR,eA+BI;AAAG,QAAA,SAAS,EAAC,WAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA0BJ,IAAI,CAACkD,IAA/B,CA/BJ,eAgCI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAhCJ,eAiCI;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oCACc,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,GAAEhB,QAAS,EAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAA0BE,UAA1B,MADd,SAEQ,IAAIe,IAAJ,CAASnD,IAAI,CAACoD,OAAd,EAAuBC,YAAvB,EAFR,CAjCJ,eAqCI;AAAK,QAAA,SAAS,EAAC,gBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,GAAX;AAAe,QAAA,SAAS,EAAC,wCAAzB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yBADJ,EAKKzD,eAAe,GAAGY,IAAlB,IAA0BZ,eAAe,GAAGY,IAAlB,CAAuBC,GAAvB,KAA+BT,IAAI,CAACmC,QAAL,CAAc1B,GAAvE,iBACG,uDACI,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAG,cAAaT,IAAI,CAACS,GAAI,EAAjC;AAAoC,QAAA,SAAS,EAAC,wCAA9C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,eAII;AAAQ,QAAA,OAAO,EAAE,KAAKoB,eAAtB;AAAuC,QAAA,SAAS,EAAC,2BAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAJJ,CANR,eAgBI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACKjC,eAAe,GAAGY,IAAlB,IAA0BZ,eAAe,GAAGY,IAAlB,CAAuB8C,IAAvB,KAAgC,OAA1D,iBACG;AAAK,QAAA,KAAK,EAAC,WAAX;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAK,QAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,sBACI;AAAI,QAAA,SAAS,EAAC,YAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBADJ,eAEI;AAAG,QAAA,SAAS,EAAC,kBAAb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAFJ,eAGI,oBAAC,IAAD;AACI,QAAA,EAAE,EAAG,cAAatD,IAAI,CAACS,GAAI,EAD/B;AAEI,QAAA,SAAS,EAAC,wCAFd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAHJ,eASI;AAAQ,QAAA,OAAO,EAAE,KAAKoB,eAAtB;AAAuC,QAAA,SAAS,EAAC,2BAAjD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBATJ,CADJ,CAFR,CAhBJ,CArCJ,CADJ;AA4EH,KA/J8B;AAAA;;AAiK/B0B,EAAAA,MAAM,GAAG;AACL,UAAM;AAAEvD,MAAAA,IAAF;AAAQC,MAAAA,cAAR;AAAwBC,MAAAA,gBAAxB;AAA0CG,MAAAA;AAA1C,QAAuD,KAAKN,KAAlE;;AAEA,QAAIE,cAAJ,EAAoB;AAChB,0BAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAG,GAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACH,KAFD,MAEO,IAAIC,gBAAJ,EAAsB;AACzB,0BAAO,oBAAC,QAAD;AAAU,QAAA,EAAE,EAAG,SAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACH;;AAED,wBACI;AAAK,MAAA,SAAS,EAAC,WAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAI,MAAA,SAAS,EAAC,qBAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAqCF,IAAI,CAACyC,KAA1C,CADJ,EAGK,CAACzC,IAAD,gBACG;AAAK,MAAA,SAAS,EAAC,uBAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBACI;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,oBADJ,CADH,GAKG,KAAKiC,UAAL,CAAgBjC,IAAhB,CARR,eAWI,oBAAC,OAAD;AAAS,MAAA,MAAM,EAAEA,IAAI,CAACS,GAAtB;AAA2B,MAAA,QAAQ,EAAEJ,QAAQ,CAACmD,OAAT,EAArC;AAAyD,MAAA,cAAc,EAAE,KAAKjC,cAA9E;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAXJ,CADJ;AAeH;;AAzL8B;;AA4LnC,eAAezB,UAAf","sourcesContent":["import React, { Component } from 'react';\nimport { singlePost, remove} from './apiPost';\nimport DefaultPost from '../images/mountains.jpg';\nimport { Link, Redirect } from 'react-router-dom';\nimport { isAuthenticated } from '../auth';\nimport Comment from './Comment';\n\nclass SinglePost extends Component {\n    state = {\n        post: '',\n        redirectToHome: false,\n        redirectToSignin: false,\n        like: false,\n        likes: 0,\n        comments: []\n    };\n\n    checkLike = likes => {\n        const userId = isAuthenticated() && isAuthenticated().user._id;\n        let match = likes.indexOf(userId) !== -1;\n        return match;\n    };\n\n    componentDidMount = () => {\n        const postId = this.props.match.params.postId;\n        singlePost(postId).then(data => {\n            if (data.error) {\n                console.log(data.error);\n            } else {\n                this.setState({\n                    post: data,\n                    likes: data.likes.length,\n                    like: this.checkLike(data.likes),\n                    comments: data.comments\n                });\n            }\n        });\n    };\n\n    updateComments = comments => {\n        this.setState({ comments });\n    };\n\n    likeToggle = () => {\n        if (!isAuthenticated()) {\n            this.setState({ redirectToSignin: true });\n            return false;\n        }\n        let callApi = this.state.like ? unlike : like;\n        const userId = isAuthenticated().user._id;\n        const postId = this.state.post._id;\n        const token = isAuthenticated().token;\n\n        callApi(userId, token, postId).then(data => {\n            if (data.error) {\n                console.log(data.error);\n            } else {\n                this.setState({\n                    like: !this.state.like,\n                    likes: data.likes.length\n                });\n            }\n        });\n    };\n\n    deletePost = () => {\n        const postId = this.props.match.params.postId;\n        const token = isAuthenticated().token;\n        remove(postId, token).then(data => {\n            if (data.error) {\n                console.log(data.error);\n            } else {\n                this.setState({ redirectToHome: true });\n            }\n        });\n    };\n\n    deleteConfirmed = () => {\n        let answer = window.confirm('Are you sure you want to delete your post?');\n        if (answer) {\n            this.deletePost();\n        }\n    };\n\n    renderPost = post => {\n        const posterId = post.postedBy ? `/user/${post.postedBy._id}` : '';\n        const posterName = post.postedBy ? post.postedBy.name : ' Unknown';\n\n        const { like, likes } = this.state;\n\n        return (\n            <div className=\"card-body\">\n                <img\n                    src={`${process.env.REACT_APP_API_URL}/post/photo/${post._id}`}\n                    alt={post.title}\n                    onError={i => (i.target.src = `${DefaultPost}`)}\n                    className=\"img-thunbnail mb-3\"\n                    style={{\n                        height: '300px',\n                        width: '100%',\n                        objectFit: 'cover'\n                    }}\n                />\n\n                {like ? (\n                    <h3 onClick={this.likeToggle}>\n                        <i\n                            className=\"fa fa-thumbs-up text-success bg-dark\"\n                            style={{ padding: '10px', borderRadius: '50%' }}\n                        />{' '}\n                        {likes} Like\n                    </h3>\n                ) : (\n                    <h3 onClick={this.likeToggle}>\n                        <i\n                            className=\"fa fa-thumbs-up text-warning bg-dark\"\n                            style={{ padding: '10px', borderRadius: '50%' }}\n                        />{' '}\n                        {likes} Like\n                    </h3>\n                )}\n\n                <p className=\"card-text\">{post.body}</p>\n                <br />\n                <p className=\"font-italic mark\">\n                    Posted by <Link to={`${posterId}`}>{posterName} </Link>\n                    on {new Date(post.created).toDateString()}\n                </p>\n                <div className=\"d-inline-block\">\n                    <Link to={`/`} className=\"btn btn-raised btn-primary btn-sm mr-5\">\n                        Back to posts\n                    </Link>\n\n                    {isAuthenticated().user && isAuthenticated().user._id === post.postedBy._id && (\n                        <>\n                            <Link to={`/post/edit/${post._id}`} className=\"btn btn-raised btn-warning btn-sm mr-5\">\n                                Update Post\n                            </Link>\n                            <button onClick={this.deleteConfirmed} className=\"btn btn-raised btn-danger\">\n                                Delete Post\n                            </button>\n                        </>\n                    )}\n\n                    <div>\n                        {isAuthenticated().user && isAuthenticated().user.role === 'admin' && (\n                            <div class=\"card mt-5\">\n                                <div className=\"card-body\">\n                                    <h5 className=\"card-title\">Admin</h5>\n                                    <p className=\"mb-2 text-danger\">Edit/Delete as an Admin</p>\n                                    <Link\n                                        to={`/post/edit/${post._id}`}\n                                        className=\"btn btn-raised btn-warning btn-sm mr-5\"\n                                    >\n                                        Update Post\n                                    </Link>\n                                    <button onClick={this.deleteConfirmed} className=\"btn btn-raised btn-danger\">\n                                        Delete Post\n                                    </button>\n                                </div>\n                            </div>\n                        )}\n                    </div>\n                </div>\n            </div>\n        );\n    };\n\n    render() {\n        const { post, redirectToHome, redirectToSignin, comments } = this.state;\n\n        if (redirectToHome) {\n            return <Redirect to={`/`} />;\n        } else if (redirectToSignin) {\n            return <Redirect to={`/signin`} />;\n        }\n\n        return (\n            <div className=\"container\">\n                <h2 className=\"display-2 mt-5 mb-5\">{post.title}</h2>\n\n                {!post ? (\n                    <div className=\"jumbotron text-center\">\n                        <h2>Loading...</h2>\n                    </div>\n                ) : (\n                    this.renderPost(post)\n                )}\n\n                <Comment postId={post._id} comments={comments.reverse()} updateComments={this.updateComments} />\n            </div>\n        );\n    }\n}\n\nexport default SinglePost;"]},"metadata":{},"sourceType":"module"}